<!doctype html>
<html>

<head>

	<link rel="stylesheet" type="text/less" href="css/main.less" />

	<script type="text/javascript" src="libs/lodash/lodash.js"></script>
	<script type="text/javascript" src="libs/jquery/jquery.js"></script>
	<script type="text/javascript" src="libs/less/less.js"></script>

	<script type="text/javascript" src="js/url.js"></script>
	<script type="text/javascript" src="js/dataTransfer.js"></script>

	<script type="text/javascript">
		$(function() {
			var dataTransfer = window.dataTransfer;
			var domainSelector = $('#domainId');

			domainSelector.change(function() {
				var domainId = domainSelector.val();

				console.log('change domain to: ', domainId)
				dataTransfer.setDomainId(domainId);

				updateLinks(domainId);

				if (!domainId) {
					alert('warning: domain is null, select please.');
				}
			});

			return void(0);

			function updateLinks(domainId) {
				$('a').each(function(index, ele) {
					var urlObj = new Url(ele.href);
					urlObj.updateSearchData({
						d: domainId
					});

					var href = urlObj.getUrl();
					// href = href.substring(0, location.origin.length); // ???
					ele.href = href;
				});
			}
		});
	</script>

</head>

<body>
	<h1>Select Domain</h1>
	<div>
		<select name="doaminId" id="domainId">

			<option value="">--select--</option>

			<option value="aaa">aaa</option>
			<option value="bbbbb">bbbbb</option>
			<option value="ccc">ccc</option>
		</select>

		<ul>
			<li><a href="workpage1.html">Work Page 1</a></li>
		</ul>
	</div>
</body>

</html>
